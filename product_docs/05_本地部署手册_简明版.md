# 数学本地部署——给管理人员的简明操作说明

> 目标：让不会写代码的老师/管理人员，也能在自己电脑上跑起来“数学试卷分析助手”。

---

## 一、准备工作（只做一次）

1. 电脑系统  
   - Windows 10 或 Windows 11。

2. 安装 Node.js  
   - 打开浏览器，访问：https://nodejs.org  
   - 点击 “LTS” 版本下载并安装（一路“下一步”即可）。  
   - 安装后，打开“开始菜单 → Windows PowerShell”，输入：  
     `node -v`  
     如果能看到类似 `v18.x.x` 这样的版本号，就说明成功。

3. 拿到项目文件  
   - 管理员把完整的 `试卷分析助手` 文件夹发给你（U 盘或网盘）。  
   - 放在 `D:\` 盘，最终路径建议是：  
     `D:\试卷分析助手`

4. 向技术同事索要 `.env` 文件（大模型密钥）  
   - 把他给你的 `.env` 放到：`D:\试卷分析助手\backend` 里面。  
   - 不要修改里面的内容，也不要发给别人。

到这里，“准备工作”就完成了，后面每次使用只需要执行“二、三”两步。

---

## 二、启动服务（每次使用前都要做）

### 第一步：启动后端（负责分析）

1. 打开“开始菜单 → Windows PowerShell”。  
2. 输入下面两行命令，每行输完按一次回车：

```powershell
cd "D:\试卷分析助手\backend"
npx ts-node server.ts
```

3. 看到类似下面的字样就表示成功（不用完全一样）：

```text
🚀 后端服务已启动: http://localhost:3002
👉 分析接口地址: http://localhost:3002/api/analyze-exam
```

4. 这一窗口**一定要保持打开**，不要关闭。

### 第二步：启动前端（网页界面）

1. 再打开一个新的“Windows PowerShell”窗口。  
2. 输入下面两行命令：

```powershell
cd "D:\试卷分析助手\frontend\web"
npm run dev
```

3. 成功后会看到类似：

```text
Local:   http://localhost:3000/
```

4. 用浏览器（推荐 Edge 或 Chrome）打开地址栏输入：  
   `http://localhost:3000`  
   即可看到“试卷分析助手”的首页。

---

## 三、老师如何使用（数学版）

### 1. 录入本次考试数据

1. 打开 `http://localhost:3000`。  
2. 确认顶部学生信息（姓名、年级、班级、科目为“数学”）。  
3. 在“本次考试数据录入”区域，建议使用 **表格导入**：
   - 准备一份包含学生成绩的 Excel/CSV（可以让技术同事给模板）。  
   - 点击“表格导入”，选择对应文件。  
   - 成功后，会在页面中间看到“本次考试概览（当前学生）”的小卡片。

> 拍照录入功能依赖 AI 识别图片，目前建议由技术人员先试用，老师日常以“表格导入”为主。

### 2. 生成个人分析报告

1. 确认页面中已经有“本次考试概览”卡片。  
2. 点击底部绿色按钮“生成个人分析报告”。  
3. 等待几十秒，系统会自动跳转到“个人分析报告”页面，内容包括：
   - 成绩摘要  
   - 整体评价  
   - 主要问题（薄弱知识点）  
   - 关键错题  
   - 结论与建议  
   - 题型能力分析（题型对应的能力与得分情况）

### 3. 保存或发送报告

1. 在报告页面，按键盘 `Ctrl + P` 打开打印界面。  
2. 将打印机选择为“保存为 PDF”或“Microsoft Print to PDF”。  
3. 保存到电脑中，即可：
   - 打印纸质版给家长；  
   - 通过微信、钉钉把 PDF 发给家长。

### 4. 查看历史考试和趋势

1. 回到首页，点击底部左侧“切换考试”。  
2. 在弹出的窗口中：
   - 可以选择某一次历史考试，切换查看。  
   - 点击“学情趋势分析”卡片，可以看到最近多次考试的成绩走势和能力变化。

---

## 四、遇到问题怎么办？

### 1. 网页弹出“分析失败：API error”

可能原因：
- 后端没有启动（或者中途被关闭）。  
- 网络或大模型服务异常。

处理建议：
1. 检查运行后端的 PowerShell 窗口是否还在；  
2. 如有红色报错内容，截图发给技术同事；  
3. 必要时关闭两个窗口，重新按照“二、启动服务”步骤来一遍。

### 2. 打不开 `http://localhost:3000`

可能原因：
- 前端没有启动成功。

处理建议：
1. 查看运行 `npm run dev` 的窗口是否有报错；  
2. 关闭该窗口，重新执行：

```powershell
cd "D:\试卷分析助手\frontend\web"
npm run dev
```

---

## 五、结束使用

1. 分析工作完成后：
   - 可以关闭浏览器。  
   - 依次关闭两个 PowerShell 窗口（前端、后端）。
2. 下次使用时，直接从“二、启动服务”开始即可，无需重复安装。

---

如有任何步骤看不懂，建议在第一次操作时请技术同事陪同，走一遍流程；熟悉之后，管理人员可以完全独立完成以上所有操作。***
