# 前端开发任务清单

## 📋 概述

本文档列出了对接质量优化项目新功能所需的前端开发任务。所有后端功能已完成并测试通过，前端可以开始开发。

**优先级**: P0 > P1 > P2  
**预计工作量**: 3-5天  
**开始日期**: 2026年1月13日

---

## 🔴 P0任务 - 核心功能UI（必须完成）

### 1. 低置信度警告显示 ⭐⭐⭐
**优先级**: 最高  
**预计工作量**: 4小时  
**依赖**: 无

**任务描述**:
创建低置信度警告组件，在分析结果页面显示警告信息。

**技术要点**:
- 根据警告级别（low/medium/high）显示不同颜色
- 显示警告消息和改进建议
- 列出受影响的项目

**API字段**:
```typescript
response.data.lowConfidenceWarning?: {
  hasWarning: boolean;
  level: 'none' | 'low' | 'medium' | 'high';
  message: string;
  suggestions: string[];
  affectedItems: string[];
}
```

**UI设计建议**:
- 低级警告: 黄色背景，信息图标
- 中级警告: 橙色背景，警告图标
- 高级警告: 红色背景，错误图标

**验收标准**:
- [ ] 能正确显示不同级别的警告
- [ ] 警告消息清晰易懂
- [ ] 建议列表完整显示
- [ ] 响应式设计，移动端友好

---

### 2. 渐进式加载动画 ⭐⭐⭐
**优先级**: 最高  
**预计工作量**: 6小时  
**依赖**: SSE事件处理

**任务描述**:
实现分析过程的渐进式加载，分阶段显示结果。

**技术要点**:
- 监听SSE事件流
- 显示实时进度条（0-100%）
- 显示当前阶段消息
- 显示预计剩余时间
- 分阶段渲染部分结果

**阶段说明**:
1. **extracting (10%)**: 显示"正在识别试卷内容..."
2. **extracted (30%)**: 显示试卷基本信息（学科、年级、得分）
3. **diagnosing (50%)**: 显示"正在分析错因..."
4. **diagnosed (70%)**: 显示Top3错因
5. **practicing (85%)**: 显示"正在生成练习题..."
6. **completed (100%)**: 显示完整报告

**API事件**:
```typescript
// progress事件
{
  type: 'progress';
  stage: string;
  message: string;
  progress: number;
  estimatedSeconds: number;
}

// partial_result事件
{
  type: 'partial_result';
  stage: 'extracted' | 'diagnosed';
  result: any;
}
```

**验收标准**:
- [ ] 进度条平滑更新
- [ ] 阶段消息实时显示
- [ ] 剩余时间准确显示
- [ ] 部分结果立即渲染
- [ ] 用户体验流畅

---

### 3. 用户反馈表单 ⭐⭐
**优先级**: 高  
**预计工作量**: 4小时  
**依赖**: 无

**任务描述**:
在分析结果页面添加反馈按钮和表单，收集用户反馈。

**技术要点**:
- 反馈按钮位置：分析结果页面底部或侧边
- 表单字段：类型、评分、详细反馈
- 提交后显示感谢消息

**API接口**:
```typescript
POST /api/feedback
{
  type: 'accuracy' | 'quality' | 'suggestion' | 'bug' | 'other';
  rating?: number;  // 1-5星
  comment?: string;
  context?: {
    analysisId?: string;
    examName?: string;
  };
}
```

**UI设计建议**:
- 反馈按钮：固定在页面右下角或底部
- 表单：模态框或侧边栏
- 评分：星级评分组件
- 类型：下拉选择

**验收标准**:
- [ ] 反馈按钮位置合理
- [ ] 表单字段完整
- [ ] 星级评分交互流畅
- [ ] 提交成功有反馈
- [ ] 表单验证完善

---

## 🟡 P1任务 - 增强功能UI（建议完成）

### 4. 证据来源追溯界面 ⭐⭐
**优先级**: 中  
**预计工作量**: 6小时  
**依赖**: 图片查看器

**任务描述**:
在每个错因旁边显示"查看原图"按钮，点击后显示对应的原始图片。

**技术要点**:
- 在错因列表中添加"查看原图"按钮
- 点击按钮打开图片查看器
- 高亮显示证据相关区域（可选）

**API字段**:
```typescript
response.data.evidenceSourceTracking?: {
  totalImages: number;
  sources: Array<{
    problemIndex: number;
    imageIndex?: number;
    canViewOriginal: boolean;
  }>;
}
```

**UI设计建议**:
- 按钮样式：小型、蓝色、带图标
- 图片查看器：模态框或全屏
- 支持左右切换图片
- 支持缩放和拖动

**验收标准**:
- [ ] 按钮显示在正确位置
- [ ] 点击打开对应图片
- [ ] 图片查看器功能完善
- [ ] 支持键盘快捷键
- [ ] 移动端友好

---

### 5. 质量指标仪表盘 ⭐
**优先级**: 中  
**预计工作量**: 4小时  
**依赖**: 无

**任务描述**:
在分析结果页面顶部显示质量指标仪表盘。

**技术要点**:
- 显示4个维度的质量指标
- 使用进度条或圆形图表
- 总体评分突出显示

**API字段**:
```typescript
response.qualityMetrics?: {
  recognitionConfidence: number;    // 0-1
  analysisConfidence: number;       // 0-1
  evidenceCompleteness: number;     // 0-1
  contentReadability: number;       // 0-1
  overallScore: number;             // 0-100
}
```

**UI设计建议**:
- 布局：4个小卡片 + 1个总分卡片
- 颜色：绿色（≥90%）、黄色（70-90%）、红色（<70%）
- 图表：环形进度条或线性进度条

**验收标准**:
- [ ] 指标显示清晰
- [ ] 颜色编码合理
- [ ] 总分突出显示
- [ ] 响应式布局
- [ ] 动画效果流畅

---

### 6. 时长估算显示优化 ⭐
**优先级**: 中  
**预计工作量**: 2小时  
**依赖**: 渐进式加载

**任务描述**:
优化剩余时间的显示方式，提供更好的用户体验。

**技术要点**:
- 格式化时间显示（如"约1分钟"、"约30秒"）
- 添加动画效果
- 时间接近0时显示"即将完成"

**API字段**:
```typescript
{
  estimatedSeconds: number;  // 预计剩余秒数
}
```

**UI设计建议**:
- 位置：进度条下方或右侧
- 格式：
  - ≥60秒: "约X分钟"
  - 30-60秒: "约1分钟"
  - 10-30秒: "约30秒"
  - <10秒: "即将完成"

**验收标准**:
- [ ] 时间格式友好
- [ ] 更新平滑
- [ ] 接近完成时有提示
- [ ] 不会出现负数

---

## 🟢 P2任务 - 优化功能（可选）

### 7. 反馈数据可视化（管理员）
**优先级**: 低  
**预计工作量**: 6小时  
**依赖**: 管理员权限系统

**任务描述**:
为管理员创建反馈数据可视化页面。

**API接口**:
```typescript
GET /api/feedback/summary
```

**功能**:
- 总反馈数统计
- 平均评分显示
- 按类型分布图表
- 按评分分布图表
- 最近反馈列表

---

### 8. 离线模式支持
**优先级**: 低  
**预计工作量**: 8小时  
**依赖**: Service Worker

**任务描述**:
支持离线查看历史分析结果。

**功能**:
- 缓存分析结果
- 离线时显示缓存数据
- 网络恢复时同步

---

### 9. 移动端优化
**优先级**: 低  
**预计工作量**: 10小时  
**依赖**: 响应式设计

**任务描述**:
优化移动端用户体验。

**功能**:
- 触摸手势支持
- 移动端专用布局
- 性能优化

---

## 📦 技术栈建议

### 推荐库
- **SSE客户端**: 原生 EventSource API
- **进度条**: nprogress 或 react-circular-progressbar
- **图表**: recharts 或 chart.js
- **图片查看器**: react-image-lightbox 或 photoswipe
- **表单**: react-hook-form
- **通知**: react-toastify

### 状态管理
- 使用 React Context 或 Redux 管理分析状态
- 使用 SWR 或 React Query 管理API请求

---

## 🧪 测试要求

### 单元测试
- [ ] 低置信度警告组件
- [ ] 反馈表单验证
- [ ] 时间格式化函数

### 集成测试
- [ ] SSE事件处理
- [ ] 渐进式加载流程
- [ ] 反馈提交流程

### E2E测试
- [ ] 完整分析流程
- [ ] 查看原图功能
- [ ] 提交反馈功能

---

## 📅 开发计划

### 第1天（P0核心功能）
- [ ] 上午：低置信度警告组件
- [ ] 下午：渐进式加载基础框架

### 第2天（P0核心功能）
- [ ] 上午：渐进式加载完善
- [ ] 下午：用户反馈表单

### 第3天（P1增强功能）
- [ ] 上午：证据来源追溯
- [ ] 下午：质量指标仪表盘

### 第4天（集成测试）
- [ ] 上午：前后端联调
- [ ] 下午：修复问题

### 第5天（优化和测试）
- [ ] 上午：性能优化
- [ ] 下午：用户测试

---

## 🔗 相关文档

- `API文档_新增功能.md` - API接口详细说明
- `质量优化项目完成报告.md` - 项目总结
- `P0_P1_PROGRESS_SUMMARY.md` - 进度总结

---

## 📞 联系方式

**后端支持**: 查看后端文档或联系后端团队  
**设计支持**: 参考UI设计稿  
**测试支持**: 使用提供的测试环境

---

## ✅ 验收标准

### P0任务验收
- [ ] 所有P0任务完成
- [ ] 低置信度警告正确显示
- [ ] 渐进式加载流畅运行
- [ ] 用户反馈功能正常

### P1任务验收
- [ ] 证据追溯功能可用
- [ ] 质量指标清晰展示
- [ ] 时长估算准确友好

### 整体验收
- [ ] 所有功能测试通过
- [ ] 无明显bug
- [ ] 性能良好
- [ ] 用户体验流畅

---

**文档版本**: v1.0  
**创建日期**: 2026年1月12日  
**维护者**: 项目团队
